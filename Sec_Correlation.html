<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Linear Correlation of Variables (R1)</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Team Based Statistics">
<meta property="book:author" content="Tien Chih">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  tex: {
    inlineMath: [['\\(','\\)']],
    tags: "none",
    tagSide: "right",
    tagIndent: ".8em",
    packages: {'[+]': ['base', 'extpfeil', 'ams', 'amscd', 'newcommand', 'knowl']}
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|ignore-math",
    processHtmlClass: "process-math",
    renderActions: {
        findScript: [10, function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        }, '']
    },
  },
  chtml: {
    scale: 0.88,
    mtextInheritFont: true
  },
  loader: {
    load: ['input/asciimath', '[tex]/extpfeil', '[tex]/amscd', '[tex]/newcommand', '[pretext]/mathjaxknowl3.js'],
    paths: {pretext: "https://pretextbook.org/js/lib"},
  },
  startup: {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
},
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* pre with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-sage',
                       linked: true,
                       languages: ['sage'],
                       evalButtonText: 'Evaluate (Sage)'});
</script><script>// Make *any* pre with class 'sagecell-r' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({inputLocation: 'pre.sagecell-r',
                       linked: true,
                       languages: ['r'],
                       evalButtonText: 'Evaluate (R)'});
</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.13/pretext.js"></script><script>miniversion=0.674</script><script src="https://pretextbook.org/js/0.13/pretext_add_on.js?x=1"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/colors_blue_red.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.4/setcolors.css" rel="stylesheet" type="text/css">
</head>
<body class="pretext-book ignore-math has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\Q}{\terminology{Question:\ }}
\newcommand{\Sol}{\terminology{Solution:\ }}
\newcommand{\Fisg}{\emph{Fisg}}
\newcommand{\Iisg}{\emph{Iisg}}
\newcommand{\Pisg}{\emph{Pisg}}
\newcommand{\Tisg}{\emph{Tisg}}
\newcommand{\Dom}{\emph{Dom}}
\newcommand{\Img}{\emph{Im}}
\DeclareMathOperator{\id}{id}
\newcommand{\bcup}{\displaystyle\bigcup}
\newcommand{\bcap}{\displaystyle\bigcap}
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\dint}{\displaystyle\int}
\newcommand{\R}[1]{\mathbb{R}^{#1}}
\newcommand{\C}[1]{\mathbb{C}^{#1}}
\newcommand{\Z}[1]{\mathbb{Z}^{#1}}
\newcommand{\K}[1]{\mathbb{K}^{#1}}
\newcommand{\limit}[2]{\displaystyle{ \lim_{#1 \to #2}}}
\newcommand{\TCB}[1]{\textcolor{blue}{#1}}
\newcommand{\TCR}[1]{\textcolor{red}{#1}}
\newcommand{\TCO}[1]{\textcolor{orange}{#1}}
\newcommand{\TCG}[1]{\textcolor{ForestGreen}{#1}}
\DeclareMathOperator{\Endo}{Endo}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Obj}{Obj}
\DeclareMathOperator{\pleat}{\mathcal{P}\ell}
\def\PX{\mathfrak{W}G}
\def\Gph{\mathsf{Gph}}
\def\HoGph{\mathsf{HoGph}}
\def\into{\hookrightarrow}
\def\con{\underline{}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="book-1.html"><span class="title">Team Based Statistics</span></a></h1>
<p class="byline">Tien Chih</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="Chap_LinearRegression.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="Chap_LinearRegression.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="Sec_InterpretingRegression.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="Chap_LinearRegression.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="Chap_LinearRegression.html" title="Up">Up</a><a class="next-button button toolbar-item" href="Sec_InterpretingRegression.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter-1.html" data-scroll="frontmatter-1" class="internal"><span class="title">Front Matter</span></a><ul>
<li><a href="learning-outcomes.html" data-scroll="learning-outcomes" class="internal">Learning Outcomes and Usage</a></li>
<li><a href="colophon-1.html" data-scroll="colophon-1" class="internal">Colophon</a></li>
<li><a href="author-bio-TC.html" data-scroll="author-bio-TC" class="internal">Author Biography</a></li>
<li><a href="dedication-1.html" data-scroll="dedication-1" class="internal">Dedication</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_DataBasics.html" data-scroll="Chap_DataBasics" class="internal"><span class="codenumber">1</span> <span class="title">Data Basics (B)</span></a><ul>
<li><a href="Sec_Variables.html" data-scroll="Sec_Variables" class="internal">Types of Variables and their Relationships (B1)</a></li>
<li><a href="Sec_Sampling.html" data-scroll="Sec_Sampling" class="internal">Sampling Techniques (B2)</a></li>
<li><a href="Sec_Visualization.html" data-scroll="Sec_Visualization" class="internal">Visualizing Data (B3)</a></li>
<li><a href="Sec_Center.html" data-scroll="Sec_Center" class="internal">Centers of Data (B4)</a></li>
<li><a href="Sec_Variation.html" data-scroll="Sec_Variation" class="internal">Variation of Data (B5)</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Probability.html" data-scroll="Chap_Probability" class="internal"><span class="codenumber">2</span> <span class="title">Probability (P)</span></a><ul>
<li><a href="Sec_Introprob.html" data-scroll="Sec_Introprob" class="internal">Introduction to Probability (P1)</a></li>
<li><a href="Sec_Conditionalprob.html" data-scroll="Sec_Conditionalprob" class="internal">Conditional Probability (P2)</a></li>
<li><a href="Sec_Bayes.html" data-scroll="Sec_Bayes" class="internal">Bayes Theorem (P3)</a></li>
<li><a href="Sec_RandomVariables.html" data-scroll="Sec_RandomVariables" class="internal">Random Variables (P4)</a></li>
<li><a href="Sec_LinearCombofVariables.html" data-scroll="Sec_LinearCombofVariables" class="internal">Linear Combinations of Random Variables (P5)</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Distributions.html" data-scroll="Chap_Distributions" class="internal"><span class="codenumber">3</span> <span class="title">Distributions (D)</span></a><ul>
<li><a href="Sec_StandardNormal.html" data-scroll="Sec_StandardNormal" class="internal">Standard Normal Distribution (D1)</a></li>
<li><a href="Sec_GeneralNormal.html" data-scroll="Sec_GeneralNormal" class="internal">General Normal Distribution (D2)</a></li>
<li><a href="Sec_Counting.html" data-scroll="Sec_Counting" class="internal">Counting Principles (D3)</a></li>
<li><a href="Sec_Binomial.html" data-scroll="Sec_Binomial" class="internal">Binomial Distribution (D4)</a></li>
<li><a href="Sec_NormalApprox.html" data-scroll="Sec_NormalApprox" class="internal">Normal Approximation (D5)</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Foundations.html" data-scroll="Chap_Foundations" class="internal"><span class="codenumber">4</span> <span class="title">Foundations for Inference (F)</span></a><ul>
<li><a href="Sec_PointEstimates.html" data-scroll="Sec_PointEstimates" class="internal">Point Estimates (F1)</a></li>
<li><a href="Sec_ConfidenceInterval.html" data-scroll="Sec_ConfidenceInterval" class="internal">Introduction to Confidence Intervals (F2)</a></li>
<li><a href="Sec_HypothesisTesing.html" data-scroll="Sec_HypothesisTesing" class="internal">Introduction to Hypothesis Testing (F3)</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Categorical.html" data-scroll="Chap_Categorical" class="internal"><span class="codenumber">5</span> <span class="title">Inference for Categorical Variables (C)</span></a><ul>
<li><a href="Sec_SizeofSampleCat.html" data-scroll="Sec_SizeofSampleCat" class="internal">Size of Samples (Categorical)</a></li>
<li><a href="Sec_TwoVarCat.html" data-scroll="Sec_TwoVarCat" class="internal">Comparing Two Categorical Variables (C2)</a></li>
<li><a href="Sec_ChiSquare.html" data-scroll="Sec_ChiSquare" class="internal">Chi-Squared Test and Goodness of Fit (C3)</a></li>
<li><a href="Sec_ChiIndependence.html" data-scroll="Sec_ChiIndependence" class="internal">Chi-Squared Test and Independence (C4)</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Numerical.html" data-scroll="Chap_Numerical" class="internal"><span class="codenumber">6</span> <span class="title">Inference for Numerical Variables (N)</span></a><ul>
<li><a href="Sec_tVariable.html" data-scroll="Sec_tVariable" class="internal">The <span class="process-math">\(t\)</span>-Variable and Sampling Distribution of Numerical Variables (N1)</a></li>
<li><a href="Sec_OneVarNum.html" data-scroll="Sec_OneVarNum" class="internal">Confidence Intervals and Hypothesis Testing for a single Numerical Variable (N2)</a></li>
<li><a href="Sec_PairedData.html" data-scroll="Sec_PairedData" class="internal">Paired Numerical Data (N3)</a></li>
<li><a href="Sec_TwoVarNum.html" data-scroll="Sec_TwoVarNum" class="internal">Comparing Two Numerical Variables (N4)</a></li>
<li><a href="Sec_SizeofSampleNum.html" data-scroll="Sec_SizeofSampleNum" class="internal">Size of Samples of Numerical Variables (N5)</a></li>
<li><a href="Sec_ANOVA.html" data-scroll="Sec_ANOVA" class="internal">ANOVA: Analysis of Variation (N6)</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_LinearRegression.html" data-scroll="Chap_LinearRegression" class="internal"><span class="codenumber">7</span> <span class="title">Linear Regression (R)</span></a><ul>
<li><a href="Sec_Correlation.html" data-scroll="Sec_Correlation" class="active">Linear Correlation of Variables (R1)</a></li>
<li><a href="Sec_InterpretingRegression.html" data-scroll="Sec_InterpretingRegression" class="internal">Interpreting Linear Regression (R2)</a></li>
<li><a href="Sec_InferenceRegression.html" data-scroll="Sec_InferenceRegression" class="internal">Inference and Linear Regression (R3)</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="pretext-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="Sec_Correlation"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">7.1</span> <span class="title">Linear Correlation of Variables (R1)</span>
</h2>
<section class="introduction" id="introduction-194"><p id="p-1741">In other math courses, we likely have seen  relationships between variables where one can directly compute the value of one variable based on another.  For example if we knew the length of a side of a square, we can exactly compute the area of the square.</p>
<p id="p-1742">Things in statistics are rarely so exact.  Nevertheless, we can often identify relationships between variables, and make <em class="emphasis">predictions</em> of one variable based on the values of the other.  In this section, we introduce the notion of correlation of variables.</p>
<article class="exploration project-like" id="exploration-possums"><h3 class="heading">
<span class="type">Exploration</span><span class="space"> </span><span class="codenumber">7.1.1</span><span class="period">.</span><span class="space"> </span><span class="title">Dimensions of Possums.</span>
</h3>
<div class="introduction" id="introduction-195"><p id="p-1743">Run the following code to download  the <code class="code-inline tex2jax_ignore">possum.csv</code>  data set which contains information about 104 possums, and various attributes of the possums: <pre class="ptx-sagecell sagecell-r" id="sage-338"><script type="text/x-sage">possum = read.csv("https://github.com/TienChih/tbil-stats/raw/main/data/possum.csv")

names(possum)
</script></pre> Click here to learn more about this data set: <a class="external" href="https://www.openintro.org/data/index.php?data=possum" target="_blank"><code class="code-inline tex2jax_ignore">https://www.openintro.org/data/index.php?data=possum</code></a>.</p></div>
<article class="task exercise-like" id="task-990"><h4 class="heading"><span class="codenumber">(a)</span></h4>
<p id="p-1744">Run the following code to plot the head lengths of the possum (in mm), versus their skull width (in mm). <pre class="ptx-sagecell sagecell-r" id="sage-339"><script type="text/x-sage">plot(possum$skull_w, possum$head_l, pch=19)
</script></pre></p></article><article class="task exercise-like" id="task-991"><h4 class="heading"><span class="codenumber">(b)</span></h4>
<p id="p-1745">If one were to catch two possums, one with a 53mm skull width and one with a 62mm skull width, which one would you predict had a longer head (without measuring)?  How confident would you be in your prediction?</p></article><article class="task exercise-like" id="task-992"><h4 class="heading"><span class="codenumber">(c)</span></h4>
<p id="p-1746">If you had to guess what the head lengths were for possums with a 53mm and 62mm skull widths, what would they be?  How confident would you be in your guesses?</p></article><article class="task exercise-like" id="task-993"><h4 class="heading"><span class="codenumber">(d)</span></h4>
<p id="p-1747">If you had to guess what which skull width would give you a head length of 92mm, what would you guess?  How confident would you be in your guess?</p></article></article></section><section class="subsection" id="subsection-45"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">7.1.1</span> <span class="title">Linear Fit of Data</span>
</h3>
<article class="remark remark-like" id="remark-66"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">7.1.1</span><span class="period">.</span>
</h4>
<p id="p-1748">The central theme of this chapter is finding a <em class="alert">linear</em> relationship between variables.  In other words, we wish to find a linear equation <span class="process-math">\(y=b_1x+b_0\)</span> that best describes the relationship between the variables. <figure class="figure figure-like" id="figure-45"><div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel middle" style="width:50%;"><img src="external/images/examplescatter.png" class="contained" alt="An Example Scatterplot."></div>
<div class="sbspanel middle" style="width:50%;"><img src="external/images/examplescatterandlr.png" class="contained" alt="An Example Scatterplot with a “best-fit” line."></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.2<span class="period">.</span></span><span class="space"> </span>Given a set of data, our goal is to identify a “best” linear relationship between them.</figcaption></figure></p>
<p id="p-1749">In order for this to be a sensible task to embark on, the underlying variables <em class="emphasis">should actually have a linear relationship</em>, or we should have good reason to think that they have a linear relationship.</p>
<ul class="disc">
<li id="li-425"><p id="p-derived-li-425">It's sensible for the monthly profit of a company (with one product) to coincide with how many units they sold, since there is a fixed price per unit.</p></li>
<li id="li-426"><p id="p-derived-li-426">It is <em class="emphasis">not</em> sensible for the areas of squares to have a linear relationship with the length of sides, since areas are the squares of sides, which gives a quadratic relationship.</p></li>
</ul></article><article class="activity project-like" id="activity-whichlinear"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.1.2</span><span class="period">.</span><span class="space"> </span><span class="title">Which are Linear?</span>
</h4>
<div class="introduction" id="introduction-196"><p id="p-1750">Of course, when we don't yet understand what the relationship between variables are, or we are dealing with new variables, it may not be clear if they have linear relationships.  In this case, our best approach is to look at samples, and try to eyeball which have linear, or linear-ish relationships.</p></div>
<article class="task exercise-like" id="task-994"><h5 class="heading"><span class="codenumber">(a)</span></h5>
<p id="p-1751">Determine which of the following appear to have linear relationships. <div class="sidebyside"><div class="sbsrow" style="margin-left:0.166666666666667%;margin-right:0.166666666666667%;">
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-46"><img src="external/images/splot1.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.3<span class="period">.</span></span><span class="space"> </span>(a)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-47"><img src="external/images/splot2.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.4<span class="period">.</span></span><span class="space"> </span>(b)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-48"><img src="external/images/splot3.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.5<span class="period">.</span></span><span class="space"> </span>(c)</figcaption></figure></div>
</div></div> <div class="sidebyside"><div class="sbsrow" style="margin-left:0.166666666666667%;margin-right:0.166666666666667%;">
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-49"><img src="external/images/splot4.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.6<span class="period">.</span></span><span class="space"> </span>(d)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-50"><img src="external/images/splot5.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.7<span class="period">.</span></span><span class="space"> </span>(e)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-51"><img src="external/images/splot6.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.8<span class="period">.</span></span><span class="space"> </span>(f)</figcaption></figure></div>
</div></div></p></article></article><p id="p-1752">Of course, none of these are <em class="emphasis">perfectly</em> linear.  That's usually not the case when dealing with real data.</p>
<article class="definition definition-like" id="definition-corr"><h4 class="heading">
<span class="type">Definition</span><span class="space"> </span><span class="codenumber">7.1.9</span><span class="period">.</span><span class="space"> </span><span class="title">Correlation Coefficient.</span>
</h4>
<p id="p-1753">Given a set of data points <span class="process-math">\((x_1, y_1), \ldots, (x_n, y_n)\)</span> the <em class="emphasis">correlation coefficient</em> is a statistic <span class="process-math">\(R, -1\leq R\leq 1\)</span> which measures the strength of the linear relationship between <span class="process-math">\(x\)</span> and <span class="process-math">\(y\text{.}\)</span></p>
<p id="p-1754"><span class="process-math">\(R=1\)</span> or <span class="process-math">\(-1\)</span> denotes data that is perfectly aligned with a positive or negative sloping line respectively.  The <em class="emphasis">sign</em> of <span class="process-math">\(R\)</span> gives you the <em class="emphasis">direction</em> of the relationship: positive or negative.  The <em class="emphasis">magnitude</em> or distance from 0 determnines the <em class="emphasis">strength</em> of the relationship: weak if close to 0, strong if close to -1 or 1.</p></article><article class="activity project-like" id="activity-corr"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.1.3</span><span class="period">.</span><span class="space"> </span><span class="title">Match the Plot to <span class="process-math">\(R\)</span>.</span>
</h4>
<p id="p-1755">For each of the following, match the scatterplot to the correlation coefficient: <div class="sidebyside"><div class="sbsrow" style="margin-left:0.166666666666667%;margin-right:0.166666666666667%;">
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-52"><img src="external/images/corr35.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.10<span class="period">.</span></span><span class="space"> </span>(d)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-53"><img src="external/images/corrn97.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.11<span class="period">.</span></span><span class="space"> </span>(e)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-54"><img src="external/images/corr0.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.12<span class="period">.</span></span><span class="space"> </span>(f)</figcaption></figure></div>
</div></div> <div class="sidebyside"><div class="sbsrow" style="margin-left:0.166666666666667%;margin-right:0.166666666666667%;">
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-55"><img src="external/images/corr65.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.13<span class="period">.</span></span><span class="space"> </span>(d)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-56"><img src="external/images/corrn28.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.14<span class="period">.</span></span><span class="space"> </span>(e)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-57"><img src="external/images/corrn75.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.15<span class="period">.</span></span><span class="space"> </span>(f)</figcaption></figure></div>
</div></div> <div class="sidebyside"><div class="sbsrow" style="margin-left:0.166666666666667%;margin-right:0.166666666666667%;">
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-58"><img src="external/images/corr99.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.16<span class="period">.</span></span><span class="space"> </span>(g)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-59"><img src="external/images/corrn75.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.17<span class="period">.</span></span><span class="space"> </span>(h)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-60"><img src="external/images/corr85.png" class="contained" alt="An Example Scatterplot."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.18<span class="period">.</span></span><span class="space"> </span>(i)</figcaption></figure></div>
</div></div></p>
<ol class="decimal">
<li id="li-427"><p id="p-derived-li-427"><span class="process-math">\(\displaystyle R\approx 0.99\)</span></p></li>
<li id="li-428"><p id="p-derived-li-428"><span class="process-math">\(\displaystyle R\approx 0.85\)</span></p></li>
<li id="li-429"><p id="p-derived-li-429"><span class="process-math">\(\displaystyle R\approx 0.65\)</span></p></li>
<li id="li-430"><p id="p-derived-li-430"><span class="process-math">\(\displaystyle R\approx 0.35\)</span></p></li>
<li id="li-431"><p id="p-derived-li-431"><span class="process-math">\(\displaystyle R\approx 0\)</span></p></li>
<li id="li-432"><p id="p-derived-li-432"><span class="process-math">\(\displaystyle R\approx -0.28\)</span></p></li>
<li id="li-433"><p id="p-derived-li-433"><span class="process-math">\(\displaystyle R\approx -0.38\)</span></p></li>
<li id="li-434"><p id="p-derived-li-434"><span class="process-math">\(\displaystyle R\approx -0.75\)</span></p></li>
<li id="li-435"><p id="p-derived-li-435"><span class="process-math">\(\displaystyle R\approx -0.97\)</span></p></li>
</ol></article><article class="remark remark-like" id="remark-67"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">7.1.19</span><span class="period">.</span><span class="space"> </span><span class="title">Computing the Correlation Coefficient.</span>
</h4>
<p id="p-1756"><span class="process-math">\(R\)</span> can be computed</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
R=\frac{1}{n-1}\sum\left(\frac{x_i-\bar{x}}{s_x}\right)\left(\frac{y_i-\bar{y}}{s_y}\right)
\end{equation*}
</div>
<p class="continuation">where <span class="process-math">\(\bar{x}, \bar{y}\)</span> are the mean of the <span class="process-math">\(x\)</span> and <span class="process-math">\(y\)</span> variables, and <span class="process-math">\(s_x, s_y\)</span> are the sample standard deviations.</p>
<p id="p-1757">We won't go through the details of this computation or it's derivation.  The main take away is <span class="process-math">\(\left(\frac{x_i-\bar{x}}{s_x}\right), \left(\frac{y_i-\bar{y}}{s_y}\right)\)</span> measures the distance of the data points from their mean, scaled by the deviation.  If <span class="process-math">\(x_i\)</span> is above (or below)<span class="process-math">\(\bar{x}\)</span> whenever <span class="process-math">\(y_i\)</span> is above (or below) <span class="process-math">\(\bar{y}\text{,}\)</span> then these terms are positive and the sum is large and positive.  If one is above whenever the other is below, these terms are negative and the sum is large and negative.  If it's a mix, then the positive and negative terms cancel and you are close to 0.</p></article><article class="remark remark-like" id="remark-rsquared"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">7.1.20</span><span class="period">.</span>
</h4>
<p id="p-1758">We often square <span class="process-math">\(R\text{:}\)</span> <span class="process-math">\(R^2\text{,}\)</span> to remove the sign and just to measure the strength of the linear relationship.  <span class="process-math">\(R^2\)</span> explains what proportion of the response variable can be explained by the explanatory variable.  This can range from <span class="process-math">\(R^2=1\)</span> or 100% of the explanatory variable is explained by the response variable, to <span class="process-math">\(R^2=0\)</span> the explanatory variable has no impact at all on the response variable.</p></article></section><section class="subsection" id="subsection-46"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">7.1.2</span> <span class="title">Best Fit Lines</span>
</h3>
<article class="exploration project-like" id="exploration-bestfit"><h4 class="heading">
<span class="type">Exploration</span><span class="space"> </span><span class="codenumber">7.1.4</span><span class="period">.</span><span class="space"> </span><span class="title">Best Fit.</span>
</h4>
<p id="p-1759">For the following scatter plot: <div class="image-box" style="width: 80%; margin-left: 10%; margin-right: 10%;"><img src="external/images/linreg0.png" class="contained" alt="An Example Scatterplot."></div> Which of the following would you say is the best fit? <div class="sidebyside"><div class="sbsrow" style="margin-left:0.166666666666667%;margin-right:0.166666666666667%;">
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-61"><img src="external/images/linreg1.png" class="contained" alt="An Example Scatterplot and possible Regression Line."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.21<span class="period">.</span></span><span class="space"> </span>(a)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-62"><img src="external/images/linreg2.png" class="contained" alt="An Example Scatterplot and possible Regression Line."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.22<span class="period">.</span></span><span class="space"> </span>(b)</figcaption></figure></div>
<div class="sbspanel middle" style="width:33.1103678929766%;"><figure class="figure figure-like" id="figure-63"><img src="external/images/linreg3.png" class="contained" alt="An Example Scatterplot and possible Regression Line."><figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">7.1.23<span class="period">.</span></span><span class="space"> </span>(c)</figcaption></figure></div>
</div></div></p></article><article class="remark remark-like" id="remark-residuals"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">7.1.24</span><span class="period">.</span>
</h4>
<p id="p-1760">Of course, none of these lines perfectly represent all of these points, no line could.  There will neccesarily be some overshoot and undershoot. We want to find a line that <em class="emphasis">minimizes</em> this.</p>
<p id="p-1761">Given a point in the scatterplot <span class="process-math">\((x_i, y_i)\text{,}\)</span> and a line <span class="process-math">\(y=\beta_1x+\beta_0\text{,}\)</span> let <span class="process-math">\(\hat{y}_i:=\beta_1x_i+\beta_0\text{.}\)</span>  This is the value of <span class="process-math">\(y\)</span> that the line predicts.  Call <span class="process-math">\(e_i=y_i-\hat{y}_i\)</span> the <em class="emphasis">residual</em> or <em class="emphasis">error</em> of the line.  This is the difference between what the model predicts and the actual value.</p>
<p id="p-1762">Our goal is to minimize</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\sum e_i^2
\end{equation*}
</div>
<p class="continuation">the squared some of errors (to remove sign).</p></article><article class="activity project-like" id="activity-leastsquaresline"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.1.5</span><span class="period">.</span><span class="space"> </span><span class="title">Least Squares Line.</span>
</h4>
<div class="introduction" id="introduction-197"><p id="p-1763">The <em class="emphasis">least squares line</em> is the line which minimizes the sum of squared errors (hence the name).</p></div>
<article class="task exercise-like" id="task-995"><h5 class="heading"><span class="codenumber">(a)</span></h5>
<p id="p-1764">Consider the following scatterplot and a proposed regression line.  Note that the squared errors are on display, as is <code class="code-inline tex2jax_ignore">S</code> the sum of the squared errors. <iframe src="https://www.desmos.com/calculator/syiwpiravl" id="interactive-125" width="600" height="600"></iframe></p>
<p id="p-1765">Adjust the line to get <code class="code-inline tex2jax_ignore">S</code> as small as possible.</p></article><article class="task exercise-like" id="task-996"><h5 class="heading"><span class="codenumber">(b)</span></h5>
<p id="p-1766">How well does this line now approximate the scatterplot?</p></article></article><article class="remark remark-like" id="remark-findingregressionline"><h4 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">7.1.25</span><span class="period">.</span><span class="space"> </span><span class="title">Finding the regression line.</span>
</h4>
<p id="p-1767">The parameters for a least square line can be computed as follows:</p>
<ul class="disc">
<li id="li-436"><p id="p-derived-li-436">Recall that the slope of a line is change in <span class="process-math">\(y\)</span> over change in <span class="process-math">\(x\text{.}\)</span>  How much a variable changes (ignoring direction) can roughly be thought of as it's variation.  So we have<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\beta_1=\frac{s_y}{s_x}R.
\end{equation*}
</div>The “change” in <span class="process-math">\(y\)</span> over the “change” in <span class="process-math">\(x\text{,}\)</span> modified for sign and strength of the relationship.</p></li>
<li id="li-437">
<p id="p-1768">While we can't expect every data point to lie on this line, we should expect that “on average” that we can predict <span class="process-math">\(y\)</span> with <span class="process-math">\(x\text{.}\)</span>  Thus:</p>
<div class="displaymath process-math" data-contains-math-knowls="" id="md-9">
\begin{align*}
(y-\bar{y})\amp=\beta_1(x-\bar{x})\\
y\amp=\beta_1x-\beta_1\bar{x}+\bar{y}\\
y\amp=\beta_1x+(\bar{y}-\beta_1\bar{x}).
\end{align*}
</div>
<p class="continuation">Thus:</p>
<div class="displaymath process-math" data-contains-math-knowls="">
\begin{equation*}
\beta_0=\bar{y}-\beta_1\bar{x}.
\end{equation*}
</div>
</li>
</ul></article><article class="activity project-like" id="activity-linearregressiontech"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.1.6</span><span class="period">.</span><span class="space"> </span><span class="title">Linear Regression and Technology.</span>
</h4>
<div class="introduction" id="introduction-198">
<p id="p-1769">In practice, we use technology to perform linear regression.  Let's recall the data from <a href="" class="xref" data-knowl="./knowl/activity-leastsquaresline.html" title="Activity 7.1.5: Least Squares Line">Activity 7.1.5</a>:</p>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/activity-leastsquaresline.html">
\begin{equation*}
\begin{array}{c|c}
x \amp y\\
\hline
1 \amp 1\\
2 \amp 3\\
3 \amp 2\\
4 \amp 4\\
4 \amp 5\\
5 \amp 4\\
6 \amp 7\\
\end{array}
\end{equation*}
</div>
</div>
<article class="task exercise-like" id="task-997"><h5 class="heading"><span class="codenumber">(a)</span></h5>
<p id="p-1770">Enter this data into the columns <code class="code-inline tex2jax_ignore">x_1</code>, <code class="code-inline tex2jax_ignore">y_1</code>: <iframe src="https://www.desmos.com/calculator/fteh98brsf" id="interactive-126" width="600" height="600"></iframe></p>
<p id="p-1771">How do <code class="code-inline tex2jax_ignore">B_1</code>, <code class="code-inline tex2jax_ignore">B_0</code> compare to the <code class="code-inline tex2jax_ignore">B_1</code>, <code class="code-inline tex2jax_ignore">B_0</code> from <a href="" class="xref" data-knowl="./knowl/activity-leastsquaresline.html" title="Activity 7.1.5: Least Squares Line">Activity 7.1.5</a>?</p></article><article class="task exercise-like" id="task-998"><h5 class="heading"><span class="codenumber">(b)</span></h5>
<p id="p-1772">What is the correlation coefficient <span class="process-math">\(R\)</span>=<code class="code-inline tex2jax_ignore">r</code>?  What does this tell us about the relationship between <span class="process-math">\(y\)</span> and <span class="process-math">\(x\text{.}\)</span></p></article><article class="task exercise-like" id="task-999"><h5 class="heading"><span class="codenumber">(c)</span></h5>
<p id="p-1773">What is  <span class="process-math">\(R^2\text{?}\)</span>  What does this tell us about the relationship between <span class="process-math">\(y\)</span> and <span class="process-math">\(x\)</span> according to <a href="" class="xref" data-knowl="./knowl/remark-rsquared.html" title="Remark 7.1.20">Remark 7.1.20</a>.</p></article><article class="task exercise-like" id="task-1000"><h5 class="heading"><span class="codenumber">(d)</span></h5>
<p id="p-1774">Let's use <code class="code-inline tex2jax_ignore">R</code> to do the same.   Run the following code to produce a dataframe <code class="code-inline tex2jax_ignore">dummydata</code> with variables <code class="code-inline tex2jax_ignore">x1</code> and <code class="code-inline tex2jax_ignore">y1</code>. <pre class="ptx-sagecell sagecell-r" id="sage-340"><script type="text/x-sage">x1=c(1,2,3,4,4,5,6)
y1=c(1,3,2,4,5,4,7)

dummydata = data.frame(x1, y1)
</script></pre></p></article><article class="task exercise-like" id="task-1001"><h5 class="heading"><span class="codenumber">(e)</span></h5>
<p id="p-1775">Run the following code to create a linear model for this data, and save it as <code class="code-inline tex2jax_ignore">dummymod</code>. <pre class="ptx-sagecell sagecell-r" id="sage-341"><script type="text/x-sage">dummymod=lm(y1~x1, data=dummydata)
</script></pre> How do the intercept and slope displayed here compare to what you found in (a)?</p></article><article class="task exercise-like" id="task-1002"><h5 class="heading"><span class="codenumber">(f)</span></h5>
<p id="p-1776">Run the following code to show the correlation for this model. <pre class="ptx-sagecell sagecell-r" id="sage-342"><script type="text/x-sage">cor(dummydata$x1, dummydata$y1)
</script></pre> How does this value compare to what you found in (a)?</p></article><article class="task exercise-like" id="task-1003"><h5 class="heading"><span class="codenumber">(g)</span></h5>
<p id="p-1777">Run the following code to plot the scatterplot and the least squares line. <pre class="ptx-sagecell sagecell-r" id="sage-343"><script type="text/x-sage">plot(dummydata$x1, dummydata$y1,  pch=19)
abline(dummymod, col="red")
</script></pre></p></article></article><article class="activity project-like" id="activity-possums"><h4 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">7.1.7</span><span class="period">.</span><span class="space"> </span><span class="title">Possum Regression.</span>
</h4>
<div class="introduction" id="introduction-199"><p id="p-1778">We now return to the question from <a href="" class="xref" data-knowl="./knowl/exploration-possums.html" title="Exploration 7.1.1: Dimensions of Possums">Exploration 7.1.1</a> and see if we can give a more precise answer.</p></div>
<article class="task exercise-like" id="task-1004"><h5 class="heading"><span class="codenumber">(a)</span></h5>
<p id="p-1779">Run the following code to create a linear model for <code class="code-inline tex2jax_ignore">head_l</code>, as a function of <code class="code-inline tex2jax_ignore">skull_w</code> and save it as <code class="code-inline tex2jax_ignore">possummod</code>. <pre class="ptx-sagecell sagecell-r" id="sage-344"><script type="text/x-sage">possummod=lm(head_l~skull_w, data=possum)
</script></pre> What is the slope and <span class="process-math">\(y\)</span> intercept for the liner model?</p></article><article class="task exercise-like" id="task-1005"><h5 class="heading"><span class="codenumber">(b)</span></h5>
<p id="p-1780">Run the following code to show the correlation for this model. <pre class="ptx-sagecell sagecell-r" id="sage-345"><script type="text/x-sage">cor(possum$skull_w, possum$head_l)
</script></pre></p></article><article class="task exercise-like" id="task-1006"><h5 class="heading"><span class="codenumber">(c)</span></h5>
<p id="p-1781">What is  <span class="process-math">\(R^2\text{?}\)</span>  What proportion of the head length is determined by the skull width.  (See <a href="" class="xref" data-knowl="./knowl/remark-rsquared.html" title="Remark 7.1.20">Remark 7.1.20</a>.)</p></article><article class="task exercise-like" id="task-1007"><h5 class="heading"><span class="codenumber">(d)</span></h5>
<p id="p-1782">Run the following code to plot the scatterplot and the least squares line. <pre class="ptx-sagecell sagecell-r" id="sage-346"><script type="text/x-sage">plot(possum$skull_w, possum$head_l,  pch=19)
abline(possummod, col="red")
</script></pre></p></article><article class="task exercise-like" id="task-1008"><h5 class="heading"><span class="codenumber">(e)</span></h5>
<p id="p-1783">Run the following code to show a summary of <code class="code-inline tex2jax_ignore">possummod</code>. <pre class="ptx-sagecell sagecell-r" id="sage-347"><script type="text/x-sage">summary(possummod)
</script></pre></p></article><article class="task exercise-like" id="task-1009"><h5 class="heading"><span class="codenumber">(f)</span></h5>
<p id="p-1784">Run the following code to show a summary of <code class="code-inline tex2jax_ignore">possum</code>. <pre class="ptx-sagecell sagecell-r" id="sage-348"><script type="text/x-sage">summary(possum)
</script></pre> Pick two other numerical variables from <code class="code-inline tex2jax_ignore">possum</code> and repeat the above.</p></article></article></section></section></div></main>
</div>
</body>
</html>
