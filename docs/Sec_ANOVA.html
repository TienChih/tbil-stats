<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*       on 2021-04-27T13:17:36-06:00       *-->
<!--*   A recent stable commit (2020-08-09):   *-->
<!--* 98f21740783f166a773df4dc83cab5293ab63a4a *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ANOVA: Analysis of Variation</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", "AMScd.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script><script>$(function () {
    // Make *any* div with class 'sagecell-r' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-r',
                           linked: true,
                           languages: ['r'],
                           evalButtonText: 'Evaluate (R)'});
});
</script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/0.13/pretext_add_on.js"></script><script xmlns:svg="http://www.w3.org/2000/svg" src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script xmlns:svg="http://www.w3.org/2000/svg">sagecellEvalName='Evaluate (Sage)';
</script><link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/pretext_add_on.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/banner_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/toc_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/knowls_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/style_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/colors_default.css" rel="stylesheet" type="text/css">
<link xmlns:svg="http://www.w3.org/2000/svg" href="https://pretextbook.org/css/0.31/setcolors.css" rel="stylesheet" type="text/css">
<!-- 2019-10-12: Temporary - CSS file for experiments with styling --><link xmlns:svg="http://www.w3.org/2000/svg" href="developer.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div xmlns:svg="http://www.w3.org/2000/svg" class="hidden-content" style="display:none">\(\newcommand{\Q}{\terminology{Question:\ }}
\newcommand{\Sol}{\terminology{Solution:\ }}
\newcommand{\Fisg}{\emph{Fisg}}
\newcommand{\Iisg}{\emph{Iisg}}
\newcommand{\Pisg}{\emph{Pisg}}
\newcommand{\Tisg}{\emph{Tisg}}
\newcommand{\Dom}{\emph{Dom}}
\newcommand{\Img}{\emph{Im}}
\DeclareMathOperator{\id}{id}
\newcommand{\bcup}{\displaystyle\bigcup}
\newcommand{\bcap}{\displaystyle\bigcap}
\newcommand{\dsum}{\displaystyle\sum}
\newcommand{\dint}{\displaystyle\int}
\newcommand{\R}[1]{\mathbb{R}^{#1}}
\newcommand{\C}[1]{\mathbb{C}^{#1}}
\newcommand{\Z}[1]{\mathbb{Z}^{#1}}
\newcommand{\K}[1]{\mathbb{K}^{#1}}
\newcommand{\limit}[2]{\displaystyle{ \lim_{#1 \to #2}}}
\newcommand{\TCB}[1]{\textcolor{blue}{#1}}
\newcommand{\TCR}[1]{\textcolor{red}{#1}}
\newcommand{\TCO}[1]{\textcolor{orange}{#1}}
\newcommand{\TCG}[1]{\textcolor{ForestGreen}{#1}}
\DeclareMathOperator{\Endo}{Endo}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Obj}{Obj}
\DeclareMathOperator{\pleat}{\mathcal{P}\ell}
\def\PX{\mathfrak{W}G}
\def\Gph{\mathsf{Gph}}
\def\HoGph{\mathsf{HoGph}}
\def\into{\hookrightarrow}
\def\con{\underline{}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="book-1.html"><span class="title">Team Based Statistics</span></a></h1>
<p class="byline">Tien Chih</p>
</div>
</div></div>
<nav xmlns:svg="http://www.w3.org/2000/svg" id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3"><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="Sec_SizeofSampleNum.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="Chap_Numerical.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="Chap_LinearRegression.html" title="Next">Next</a></span></div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="Sec_SizeofSampleNum.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="Chap_Numerical.html" title="Up">Up</a><a class="next-button button toolbar-item" href="Chap_LinearRegression.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div xmlns:svg="http://www.w3.org/2000/svg" id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link frontmatter">
<a href="frontmatter-1.html" data-scroll="frontmatter-1"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1">Colophon</a></li>
<li><a href="author-bio-TC.html" data-scroll="author-bio-TC">Author Biography</a></li>
<li><a href="dedication-1.html" data-scroll="dedication-1">Dedication</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_DataBasics.html" data-scroll="Chap_DataBasics"><span class="codenumber">1</span> <span class="title">Data Basics</span></a><ul>
<li><a href="Sec_Variables.html" data-scroll="Sec_Variables">Variables</a></li>
<li><a href="Sec_Sampling.html" data-scroll="Sec_Sampling">Sampling</a></li>
<li><a href="Sec_Visualization.html" data-scroll="Sec_Visualization">Visualizing Data</a></li>
<li><a href="Sec_Center.html" data-scroll="Sec_Center">Centers of Data</a></li>
<li><a href="Sec_Variation.html" data-scroll="Sec_Variation">Variation of Data</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Probability.html" data-scroll="Chap_Probability"><span class="codenumber">2</span> <span class="title">Probability</span></a><ul>
<li><a href="Sec_Introprob.html" data-scroll="Sec_Introprob">Introduction to Probability</a></li>
<li><a href="Sec_Conditionalprob.html" data-scroll="Sec_Conditionalprob">Conditional Probability</a></li>
<li><a href="Sec_Bayes.html" data-scroll="Sec_Bayes">Bayes Theorem</a></li>
<li><a href="Sec_RandomVariables.html" data-scroll="Sec_RandomVariables">Random Variables</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Distributions.html" data-scroll="Chap_Distributions"><span class="codenumber">3</span> <span class="title">Distributions</span></a><ul>
<li><a href="Sec_StandardNormal.html" data-scroll="Sec_StandardNormal">Standard Normal Distribution</a></li>
<li><a href="Sec_GeneralNormal.html" data-scroll="Sec_GeneralNormal">General Normal Distribution</a></li>
<li><a href="Sec_Counting.html" data-scroll="Sec_Counting">Counting Principles</a></li>
<li><a href="Sec_Binomial.html" data-scroll="Sec_Binomial">Binomial Distribution</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Foundations.html" data-scroll="Chap_Foundations"><span class="codenumber">4</span> <span class="title">Foundations for Inference</span></a><ul>
<li><a href="Sec_PointEstimates.html" data-scroll="Sec_PointEstimates">Point Estimates</a></li>
<li><a href="Sec_ConfidenceInterval.html" data-scroll="Sec_ConfidenceInterval">Confidence Intervals</a></li>
<li><a href="Sec_HypothesisTesing.html" data-scroll="Sec_HypothesisTesing">Hypothesis Testing</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Categorical.html" data-scroll="Chap_Categorical"><span class="codenumber">5</span> <span class="title">Inference for Categorical Variables</span></a><ul>
<li><a href="Sec_SizeofSampleCat.html" data-scroll="Sec_SizeofSampleCat">Size of Samples (Categorical)</a></li>
<li><a href="Sec_TwoVarCat.html" data-scroll="Sec_TwoVarCat">Comparing Two Categorical Variables</a></li>
<li><a href="Sec_ChiSquare.html" data-scroll="Sec_ChiSquare">Chi-Squared Test and Goodness of Fit</a></li>
<li><a href="Sec_ChiIndependence.html" data-scroll="Sec_ChiIndependence">Chi-Squared Test and Independence</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_Numerical.html" data-scroll="Chap_Numerical"><span class="codenumber">6</span> <span class="title">Inference for Numerical Variables</span></a><ul>
<li><a href="Sec_tVariable.html" data-scroll="Sec_tVariable">The \(t\)-Variable and Sampling Distribution of Numerical Variables</a></li>
<li><a href="Sec_OneVarNum.html" data-scroll="Sec_OneVarNum">Confidence Intervals and Hypothesis Testing for a single Numerical Variable</a></li>
<li><a href="Sec_PairedData.html" data-scroll="Sec_PairedData">Paired Numerical Data</a></li>
<li><a href="Sec_TwoVarNum.html" data-scroll="Sec_TwoVarNum">Comparing Two Numerical Variables</a></li>
<li><a href="Sec_SizeofSampleNum.html" data-scroll="Sec_SizeofSampleNum">Size of Samples of Numerical Variables</a></li>
<li><a href="Sec_ANOVA.html" data-scroll="Sec_ANOVA" class="active">ANOVA: Analysis of Variation</a></li>
</ul>
</li>
<li class="link">
<a href="Chap_LinearRegression.html" data-scroll="Chap_LinearRegression"><span class="codenumber">7</span> <span class="title">Linear Regression</span></a><ul>
<li><a href="Sec_Correlation.html" data-scroll="Sec_Correlation">Linear Correlation of Variables</a></li>
<li><a href="Sec_InterpretingRegression.html" data-scroll="Sec_InterpretingRegression">Interpreting Linear Regression</a></li>
<li><a href="Sec_InferenceRegression.html" data-scroll="Sec_InferenceRegression">Inference and Linear Regression</a></li>
</ul>
</li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section xmlns:svg="http://www.w3.org/2000/svg" class="section" id="Sec_ANOVA"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">6.6</span> <span class="title">ANOVA: Analysis of Variation</span>
</h2>
<section class="introduction" id="introduction-176"><p id="p-1534">In <a href="Sec_TwoVarNum.html" class="internal" title="Section 6.4: Comparing Two Numerical Variables">Section 6.4</a>, we compared populations seperated into two groups to see if some variable differed on average between the groups.  In this section, we will look at comparing across more than two groups.</p>
<p id="p-1535">Suppose you had variable of interest across \(k\) seperate populations.  So long as the following conditions are met:</p>
<ul class="disc">
<li id="li-383">Observations are independent across groups.</li>
<li id="li-384">Observations within groups are approximately normal.</li>
<li id="li-385">Variability across groups is roughly equal.</li>
</ul>
<p data-braille="continuation">Then we may perform ANOVA (Analysis of Variation) to perform a test on the following hypothesis:</p>
<ul class="disc">
<li id="li-386">\(H_0:\) The means are the same across groups, that is: \(\mu_1=\mu_2\cdots=\mu_k\text{.}\)</li>
<li id="li-387">\(H_A::\) At least one of the means is different from another.</li>
</ul>
<article class="exploration project-like" id="exploration-battingaverage"><h6 class="heading">
<span class="type">Exploration</span><span class="space"> </span><span class="codenumber">6.6.1</span><span class="period">.</span><span class="space"> </span><span class="title">Batting Average and Position.</span>
</h6>
<div class="introduction" id="introduction-177">
<p id="p-1536">Is there any difference in batting average between different positions?  We examine 1270 players from the 2018 MLB season, and observe their batting average and position:  <code class="code-inline tex2jax_ignore">1B</code> = first base, <code class="code-inline tex2jax_ignore">2B</code> = second base, <code class="code-inline tex2jax_ignore">3B</code> = third base, <code class="code-inline tex2jax_ignore">C</code> = catcher, <code class="code-inline tex2jax_ignore">CF</code> = center field (outfield), <code class="code-inline tex2jax_ignore">DH</code> = designated hitter, <code class="code-inline tex2jax_ignore">LF</code> = left field (outfield), <code class="code-inline tex2jax_ignore">P</code> = pitcher, <code class="code-inline tex2jax_ignore">RF</code> = right field (outfield), <code class="code-inline tex2jax_ignore">SS</code> = shortstop.</p>
<p id="p-1537">Run the following code to download  the <code class="code-inline tex2jax_ignore">mlb_players_18.csv</code> the data set which contains information about 1270 players from the 2018 MLB season and display it's variables: <div class="sagecell-r" id="sage-313"><script type="text/x-sage">mlb18 = read.csv("https://github.com/TienChih/tbil-stats/raw/main/data/mlb_players_18.csv")

names(mlb18)
</script></div></p>
</div>
<article class="task exercise-like" id="task-895"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1538">Since they are special players, let's consider a subset of the players without pitchers or designated hitters.  Run the following code to produce <code class="code-inline tex2jax_ignore">batters</code> a subset of <code class="code-inline tex2jax_ignore">mlb18</code> with no pitchers or designated hitters. <div class="sagecell-r" id="sage-314"><script type="text/x-sage">batters=subset(mlb18, mlb18$position!="P" & mlb18$position!="DH")
summary(batters)
</script></div></p></article><article class="task exercise-like" id="task-896"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1539">Run the following code to plot a boxplot for the batting averages of <code class="code-inline tex2jax_ignore">batters</code> seperated by position. <div class="sagecell-r" id="sage-315"><script type="text/x-sage">boxplot(batters$AVG~batters$position)
</script></div> Is it obvious that these values come from different distributions?  Is it obvious they couldn't have?</p></article></article><article class="exploration project-like" id="exploration-randomnessANOVA"><h6 class="heading">
<span class="type">Exploration</span><span class="space"> </span><span class="codenumber">6.6.2</span><span class="period">.</span><span class="space"> </span><span class="title">Randomness.</span>
</h6>
<div class="introduction" id="introduction-178"><p id="p-1540">Much like in <a class="xref" data-knowl="./knowl/exploration-fooledbyrandom.html" title="Exploration 6.4.2: Differences in Samples">Exploration 6.4.2</a>, the issue is that it's certainly possible for two different distributions to produce similar looking samples, or for identical distributions to produce very different looking examples.</p></div>
<article class="task exercise-like" id="task-897"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1541">Run the following code to produce a data frame with two variables, a <code class="code-inline tex2jax_ignore">group</code> variable with values <code class="code-inline tex2jax_ignore">A</code>, <code class="code-inline tex2jax_ignore">B</code> and <code class="code-inline tex2jax_ignore">C</code>, and a <code class="code-inline tex2jax_ignore">values</code> variable that is identical across group, and plot boxplots of <code class="code-inline tex2jax_ignore">values</code> across the groups. <div class="sagecell-r" id="sage-316"><script type="text/x-sage">group1=c(rep("A", 30), rep("B", 30), rep("C", 30))
values1=c(rnorm(30,100,35), rnorm(30,100,35), rnorm(30,100,35))

dummy1 = data.frame(group1, values1)
summary(dummy1)
boxplot(dummy1$values1~dummy1$group1)
</script></div></p></article><article class="task exercise-like" id="task-898"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1542">Run the following code to produce another data frame with the same variables, but the <code class="code-inline tex2jax_ignore">B</code> group has a different distribution than the others. <div class="sagecell-r" id="sage-317"><script type="text/x-sage">group2=c(rep("A", 30), rep("B", 30), rep("C", 30))
values2=c(rnorm(30,100,35), rnorm(30,90,35), rnorm(30,100,35))

dummy2 = data.frame(group2, values2)
summary(dummy2)
boxplot(dummy2$values2~dummy2$group2)
</script></div></p></article></article></section><section class="subsection" id="subsection-45"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.6.1</span> <span class="title">Intuition of ANOVA</span>
</h3>
<article class="remark remark-like" id="remark-62"><h6 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">6.6.1</span><span class="period">.</span><span class="space"> </span><span class="title">Idea behind ANOVA.</span>
</h6>
<p id="p-1544">The null hypothesis of ANOVA testing is that all of the groups have identical distributions, and the alternative is that they do not.  <em class="emphasis">If</em> the null hypothesis were true, then it must follow that all the variation between the groups is driven by the natual variation of the variable itself.</p>
<p id="p-1545">So what we will do is compare the variation <em class="emphasis">between</em> groups, and variation <em class="emphasis">within</em> groups.  If the null hypothesis holds, them we would expect that these values are comparable.  If there is some discrepency, then we become more suspicious of the null.  As usual, this level of suspicion will be measured with a \(p\)-value, which measure the probability that: should the null be true that we see the levels of discrepency or greter than what's observed.</p></article><article class="activity project-like" id="activity-cropsvariationbetween"><h6 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.6.3</span><span class="period">.</span><span class="space"> </span><span class="title">Fetilizer and Crop Yields: Variation <em class="emphasis">between</em> Groups.</span>
</h6>
<div class="introduction" id="introduction-179">
<p id="p-1546">Over the next few activities, we will explore how ANOVA works with a small data set, one that is honestly too samll to be considered a serious data set in practice.  However, it will allow us to see the inner workings of ANOVA without getting bogged down in huge computations.</p>
<p id="p-1547">A farmer tests 3 types of fertilizer, A, B and C, on her crops.  She segements her farmland into different plots, applies one type of fertilizer for each plot, and in the end, records the bushels per acre for that plot.  The results are as follows:</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c|c|c}
\text{Fertilizer A} \amp \text{Fertilizer B} \amp \text{Fertilizer C} \\
\hline
176 \amp 168 \amp 177\\
173 \amp 171 \amp 179\\
175 \amp 172 \amp 173\\
179 \amp     \amp 176\\
\amp     \amp 181\\
\end{array}
\end{equation*}
</div>
</div>
<article class="task exercise-like" id="task-899"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1548">Compute \(\bar{x}\) the overall sample mean production rate for all 12 plots. <div class="sagecell-r" id="sage-318"><script type="text/x-sage">
</script></div> <a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-41" id="hint-41"><span class="type">Hint</span><span class="space"> </span><span class="title">Desmos</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-41"><div class="hint solution-like"><p id="p-1549"><iframe src="https://www.desmos.com/calculator/26lqjkar0v" id="interactive-114" width="600" height="600"></iframe></p></div></div></p></article><article class="task exercise-like" id="task-900"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1550">Compute \(\bar{x}_1\) the sample mean production rate for Fertilizer A.  Repeat for \(\bar{x}_2\) for Fertilizer B and \(\bar{x}_3\) for Fertilizer C. <div class="sagecell-r" id="sage-319"><script type="text/x-sage">
</script></div> <a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-42" id="hint-42"><span class="type">Hint</span><span class="space"> </span><span class="title">Desmos</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-42"><div class="hint solution-like"><p id="p-1551"><iframe src="https://www.desmos.com/calculator/26lqjkar0v" id="interactive-115" width="600" height="600"></iframe></p></div></div></p></article><article class="task exercise-like" id="task-901"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1552">Now that we have the overall mean, and the mean of each group, we compute the “variation” amongst the groups.</p>
<p id="p-1553">Compute \(n_1(\bar{x}_1-\bar{x})^2+n_2(\bar{x}_2-\bar{x})^2+n_3(\bar{x}_3-\bar{x})^2\text{,}\) where \(n_i\) is the size of the appropriate group.  This computes the “difference” from each groups mean from the overall mean, squared to remove signs, and weighted for the size of the group.  Call this value \(SSG\) or the “sum of squares for groups”.</p></article><article class="task exercise-like" id="task-902"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1554">Since there are \(k=3\) groups, the <em class="emphasis">degrees of freedom for groups</em>: \(df_G\) is \(k-1=3-1=2\text{.}\)  Compute the “mean square for groups”: \(MSG=\frac{SSG}{df_G}.\)</p>
<p id="p-1555">This value measure the variation between groups, normalized for the number of groups.  (If there were a lot of groups, we would see a lot of variation even if they were distributed identically, so we account for that.)</p></article></article><article class="activity project-like" id="activity-cropsvariationwithin"><h6 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.6.4</span><span class="period">.</span><span class="space"> </span><span class="title">Fetilizer and Crop Yields: Variation <em class="emphasis">within</em> Groups.</span>
</h6>
<div class="introduction" id="introduction-180"><p id="p-1556">We now continue from <a class="xref" data-knowl="./knowl/activity-cropsvariationbetween.html" title="Activity 6.6.3: Fetilizer and Crop Yields: Variation between Groups">Activity 6.6.3</a> to analyze variation within groups.</p></div>
<article class="task exercise-like" id="task-903"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1557">Luckily there is a statistic which measures variation (it's implied by the name).  Compute \(Var_1\text{,}\) the sample variance for the yield rates for Fertlizer A.  Repeat for \(Var_2, Var_3\text{.}\) <div class="sagecell-r" id="sage-320"><script type="text/x-sage">
</script></div> <a data-knowl="" class="id-ref hint-knowl original" data-refid="hk-hint-43" id="hint-43"><span class="type">Hint</span><span class="space"> </span><span class="title">Desmos</span></a><div class="hidden-content tex2jax_ignore" id="hk-hint-43"><div class="hint solution-like"><p id="p-1558"><iframe src="https://www.desmos.com/calculator/26lqjkar0v" id="interactive-116" width="600" height="600"></iframe></p></div></div></p></article><article class="task exercise-like" id="task-904"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1559">Now that we have the variance within each group, we compute the the total variation.</p>
<p id="p-1560">Compute \((n_1-1)Var_1+(n_2-1)Var_2+(n_3-3)Var_1\text{.}\)  This computes the total variance within groups, weighted for the size of the group.  Call this value \(SSE\) or the “sum of squares for errors”.</p></article><article class="task exercise-like" id="task-905"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1561">Compute the “degrees of freedom for errors” by summing the degrees of freedom for each group: \(df_{E}=(n_1-1)+(n_2-1)+(n_3-1).\)</p></article><article class="task exercise-like" id="task-906"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1562">Compute the “mean square error”: \(MSE=\frac{SSE}{df_E}.\)</p>
<p id="p-1563">This value measure the variation within groups, normalized by the size of the groups.)</p></article></article><article class="activity project-like" id="activity-cropsFstat"><h6 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.6.5</span><span class="period">.</span><span class="space"> </span><span class="title">Fetilizer and Crop Yields: \(F\)-statistic and \(p\)-value.</span>
</h6>
<div class="introduction" id="introduction-181"><p id="p-1564">We  continue from <a class="xref" data-knowl="./knowl/activity-cropsvariationwithin.html" title="Activity 6.6.4: Fetilizer and Crop Yields: Variation within Groups">Activity 6.6.4</a> to produce a \(p\)-value.</p></div>
<article class="task exercise-like" id="task-907"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1565">Compute \(F=\frac{MSG}{MSE}\text{.}\)  This is a comparison between the variation between groups and the variation within groups.</p></article><article class="task exercise-like" id="task-908"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1566">The \(F\)-distribution is a random variable who has two parameters, <code class="code-inline tex2jax_ignore">d_f1</code> and <code class="code-inline tex2jax_ignore">d_f2</code> two sets of degrees of freedom.  We compute the proportion of the distribution greater than \(F\) where <code class="code-inline tex2jax_ignore">d_f1</code>\(=df_G\text{,}\) <code class="code-inline tex2jax_ignore">d_f2</code>\(=df_E\text{.}\)</p>
<p id="p-1567">Adjust the values for <code class="code-inline tex2jax_ignore">d_f1</code>, <code class="code-inline tex2jax_ignore">d_f2</code> and <code class="code-inline tex2jax_ignore">F</code> to compute the \(p\)-value <code class="code-inline tex2jax_ignore">p</code>. <iframe src="https://www.desmos.com/calculator/hxyoc4lcbh" id="interactive-117" width="600" height="600"></iframe></p></article><article class="task exercise-like" id="task-909"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1568">Edit and run the following code to produce the \(p\)-value through <code class="code-inline tex2jax_ignore">R</code>. <div class="sagecell-r" id="sage-321"><script type="text/x-sage">pf(FIXME_F, FIXME_dfG, FICME_dfE, lower.tail = FALSE)
</script></div></p></article></article><article class="remark remark-like" id="remark-63"><h6 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">6.6.2</span><span class="period">.</span>
</h6>
<p id="p-1569">The details of the \(F\) distribution are extremely technical.  This is what you should take away:  \(F=\frac{MSG}{MSE}\text{,}\) where \(MSG\) measure the variability between groups and \(MSE\) measure the variability within groups.</p>
<ul class="disc">
<li id="li-388">If  \(MSE\) is big compared to \(MSG\) then there is a lot of variability within groups.  This variability easily explains the variability between the groups.  Thus \(F\) is small,  and the tail, and thus \(p\)-value, is big.  We fail to reject the null because the variability within groups plausibly explains our data.</li>
<li id="li-389">On the other hand, if \(MSG\) is big compared to \(MSE\text{,}\) then there is a lot of variability between groups.  More than the natural variation can explain.  There is likely some <em class="emphasis">actual</em> differences between the groups.  In these cases, \(F\) is big, the tails are small and so are the \(p\)-values.  We reject the null (when \(p\)-value \(\lt 0.05\)) when it's no longer plausible that natural variation within groups can explain our data.</li>
</ul></article><article class="remark remark-like" id="remark-ANOVAsteps"><h6 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">6.6.3</span><span class="period">.</span><span class="space"> </span><span class="title">Recap of ANOVA.</span>
</h6>
<p id="p-1570">To recall the steps of ANOVA from <a class="xref" data-knowl="./knowl/activity-cropsvariationbetween.html" title="Activity 6.6.3: Fetilizer and Crop Yields: Variation between Groups">Activity 6.6.3</a>, <a class="xref" data-knowl="./knowl/activity-cropsvariationwithin.html" title="Activity 6.6.4: Fetilizer and Crop Yields: Variation within Groups">Activity 6.6.4</a> and <a class="xref" data-knowl="./knowl/activity-cropsFstat.html" title="Activity 6.6.5: Fetilizer and Crop Yields: \(F\)-statistic and \(p\)-value">Activity 6.6.5</a>: suppose that we have a \(n\) total observations from \(k\) different groups.  There are \(n_i\) observations from group \(i\text{.}\)  We then:</p>
<ol class="decimal">
<li id="li-390">Compute \(\bar{x}\) the overall sample mean.</li>
<li id="li-391">Compute \(\bar{x}_i\) the sample mean for each group.</li>
<li id="li-392">Compute \(SSG=\sum n_i(\bar{x}_i-\bar{x})^2\) the sum of squares for groups.</li>
<li id="li-393">Compute \(df_G=k-1\) the degrees of freedom for groups.</li>
<li id="li-394">Compute \(MSG=\frac{SSG}{df_G}\) the mean squares for groups.</li>
<li id="li-395">Compute \(Var_i\) for each group.</li>
<li id="li-396">Compute \(SSE=\sum (n_i-1)Var_i\) the sum of squares for errors.</li>
<li id="li-397">Compute \(df_E=\sum (n_i-1)=n-k\) the degrees of freedom for errors.</li>
<li id="li-398">Compute \(MSE=\frac{SSE}{df_E}\) the mean squares for errors.</li>
<li id="li-399">Compute \(F=\frac{MSG}{MSE}\) the \(F\) statistic.</li>
<li id="li-400">Compute \(P(F\lt X)\) where \(X\) is a \(F\) distributed variable with parameters \(df_G, df_E\text{.}\)  This value is the \(p\)-value.</li>
<li id="li-401">Reject the  null hypothesis if \(p\)-value \(\lt 0.05\text{.}\)</li>
<li id="li-402">Marvel that even for statistics, this is a <em class="emphasis">lot</em> of computation.</li>
</ol></article></section><section class="subsection" id="subsection-46"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">6.6.2</span> <span class="title">ANOVA and <code class="code-inline tex2jax_ignore">R</code></span>
</h3>
<article class="remark remark-like" id="remark-65"><h6 class="heading">
<span class="type">Remark</span><span class="space"> </span><span class="codenumber">6.6.4</span><span class="period">.</span>
</h6>
<p id="p-1571">Note that none of the steps in <a class="xref" data-knowl="./knowl/remark-ANOVAsteps.html" title="Remark 6.6.3: Recap of ANOVA">Remark 6.6.3</a> are particularly difficult, just long and tedious.  But they're fairly straightforward tasks, and one can automate much of the work.  By entering the group sizes, sample means and sample standard deviations into <code class="code-inline tex2jax_ignore">N</code>, <code class="code-inline tex2jax_ignore">M</code>, <code class="code-inline tex2jax_ignore">S</code> below, one can compute all the necessary values: <iframe src="https://www.desmos.com/calculator/bkimjzoxki" id="interactive-118" width="600" height="600"></iframe></p>
<p id="p-1572">But we could automate more than that.</p></article><article class="activity project-like" id="activity-cropANOVAR"><h6 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.6.6</span><span class="period">.</span><span class="space"> </span><span class="title">Fetilizer and Crop Yields: <code class="code-inline tex2jax_ignore">R</code>.</span>
</h6>
<div class="introduction" id="introduction-182"><p id="p-1573">We can use commands in <code class="code-inline tex2jax_ignore">R</code> to do ANOVA directly from data.</p></div>
<article class="task exercise-like" id="task-910"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1574">Run the following code to produce a dataframe <code class="code-inline tex2jax_ignore">crops</code> with variables <code class="code-inline tex2jax_ignore">yield</code> and <code class="code-inline tex2jax_ignore">fertilizer</code>. <div class="sagecell-r" id="sage-322"><script type="text/x-sage">fertilizer=c("A", "A", "A", "A", "B", "B", "B", 
  "C","C","C","C","C")
yield=c(176, 173, 175, 179, 168, 171, 172, 177, 179, 173, 176, 181)

crops = data.frame(yield, fertilizer)
</script></div></p></article><article class="task exercise-like" id="task-911"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1575">Run the following code to create an <code class="code-inline tex2jax_ignore">aov</code> model of <code class="code-inline tex2jax_ignore">crop</code> and summarize it. <div class="sagecell-r" id="sage-323"><script type="text/x-sage">cropsaov=aov(yield~fertilizer, data=crops)
summary(cropsaov)
</script></div> How do these values compare to what we found before?</p></article><article class="task exercise-like" id="task-912"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1576">State the meaning of the \(p\)-value within the context of this problem in a complete sentence.</p></article><article class="task exercise-like" id="task-913"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1577">Do we  reject the null hypothesis?</p></article><article class="task exercise-like" id="task-914"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p id="p-1578">What sort of error could have been made? (Type 1 or Type 2)</p></article></article><article class="activity project-like" id="activity-battingaverage"><h6 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.6.7</span><span class="period">.</span><span class="space"> </span><span class="title">Fetilizer and Crop Yields: <code class="code-inline tex2jax_ignore">R</code>.</span>
</h6>
<div class="introduction" id="introduction-183"><p id="p-1579">We can finish what we started with <a class="xref" data-knowl="./knowl/exploration-battingaverage.html" title="Exploration 6.6.1: Batting Average and Position">Exploration 6.6.1</a>.</p></div>
<article class="task exercise-like" id="task-915"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1580">Run the following code to re-plot a boxplot for the batting averages of <code class="code-inline tex2jax_ignore">batters</code> seperated by position. <div class="sagecell-r" id="sage-324"><script type="text/x-sage">boxplot(batters$AVG~batters$position)
</script></div></p></article><article class="task exercise-like" id="task-916"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1581">Run the following code to create an <code class="code-inline tex2jax_ignore">aov</code> model of <code class="code-inline tex2jax_ignore">batters</code> and summarize it. <div class="sagecell-r" id="sage-325"><script type="text/x-sage">battersaov=aov(AVG~position, data=batters)
summary(battersaov)
</script></div></p></article><article class="task exercise-like" id="task-917"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1582">State the meaning of the \(p\)-value within the context of this problem in a complete sentence.</p></article><article class="task exercise-like" id="task-918"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1583">Do we  reject the null hypothesis?</p></article><article class="task exercise-like" id="task-919"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p id="p-1584">What sort of error could have been made? (Type 1 or Type 2)</p></article></article><article class="activity project-like" id="activity-relaxation"><h6 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.6.8</span><span class="period">.</span><span class="space"> </span><span class="title">Relaxation and Degree Attainment: <code class="code-inline tex2jax_ignore">R</code>.</span>
</h6>
<div class="introduction" id="introduction-184">
<p id="p-1585">Is there any impact on degree attainment and the amount of time spent relaxing?</p>
<p id="p-1586">Run the following code to download  the <code class="code-inline tex2jax_ignore">gss2010.csv</code>  data set which contains information from the 2010 social survey and display it's variables: <div class="sagecell-r" id="sage-326"><script type="text/x-sage">gss2010 = read.csv("https://github.com/TienChih/tbil-stats/raw/main/data/gss2010.csv")

names(gss2010)
</script></div></p>
</div>
<article class="task exercise-like" id="task-920"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1587">Run the following code to rplot a boxplot for the hours of relaxation in a day seperated by degree attainment. <div class="sagecell-r" id="sage-327"><script type="text/x-sage">boxplot(hrsrelax ~ degree, data=gss2010)
</script></div></p></article><article class="task exercise-like" id="task-921"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1588">Run the following code to create an <code class="code-inline tex2jax_ignore">aov</code> model of <code class="code-inline tex2jax_ignore">gss2010</code> and summarize it. <div class="sagecell-r" id="sage-328"><script type="text/x-sage">relaxaov=aov(hrsrelax ~ degree, data=gss2010)
summary(relaxaov)
</script></div></p></article><article class="task exercise-like" id="task-922"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1589">State the meaning of the \(p\)-value within the context of this problem in a complete sentence.</p></article><article class="task exercise-like" id="task-923"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1590">Do we  reject the null hypothesis?</p></article><article class="task exercise-like" id="task-924"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p id="p-1591">What sort of error could have been made? (Type 1 or Type 2)</p></article><article class="task exercise-like" id="task-925"><h6 class="heading"><span class="codenumber">(f)</span></h6>
<p id="p-1592"><code class="code-inline tex2jax_ignore">mntlhlth</code> measures “For how many days during the past 30 days was your mental health, which includes stress, depression, and problems with emotions, not good?”</p>
<p id="p-1593">Re-run the above comparing this variable across degree attainment.</p></article><article class="task exercise-like" id="task-926"><h6 class="heading"><span class="codenumber">(g)</span></h6>
<p id="p-1594"><code class="code-inline tex2jax_ignore">hrs1</code> measures “Hours worked each week.”</p>
<p id="p-1595">Re-run the above comparing this variable across degree attainment.</p></article></article><article class="activity project-like" id="activity-starbucksfoodtype"><h6 class="heading">
<span class="type">Activity</span><span class="space"> </span><span class="codenumber">6.6.9</span><span class="period">.</span><span class="space"> </span><span class="title">Starbucks Nutrition and Item Type: <code class="code-inline tex2jax_ignore">R</code>.</span>
</h6>
<div class="introduction" id="introduction-185">
<p id="p-1596">Is there any impact on the type of item Starbucks serves, <code class="code-inline tex2jax_ignore">bakery</code>, <code class="code-inline tex2jax_ignore">bistro box</code>, <code class="code-inline tex2jax_ignore">hot breakfast</code>, <code class="code-inline tex2jax_ignore">parfait</code>, <code class="code-inline tex2jax_ignore">petite</code>, <code class="code-inline tex2jax_ignore">salad</code>,  <code class="code-inline tex2jax_ignore">sandwich</code> ,and nutrition?</p>
<p id="p-1597">Run the following code to download <code class="code-inline tex2jax_ignore">starbucks.csv</code> a data set comtaining information about 77 Starbucks menu items their nutritional value and show it's variable names. <div class="sagecell-r" id="sage-329"><script type="text/x-sage">starbucks = read.csv("https://github.com/TienChih/tbil-stats/raw/main/data/starbucks.csv")

names(starbucks)
</script></div></p>
</div>
<article class="task exercise-like" id="task-927"><h6 class="heading"><span class="codenumber">(a)</span></h6>
<p id="p-1598">Run the following code to rplot a boxplot for <code class="code-inline tex2jax_ignore">fiber</code> fiber in g, seperated by food type <code class="code-inline tex2jax_ignore">type</code>. <div class="sagecell-r" id="sage-330"><script type="text/x-sage">boxplot(fiber ~ type, data=starbucks)
</script></div></p></article><article class="task exercise-like" id="task-928"><h6 class="heading"><span class="codenumber">(b)</span></h6>
<p id="p-1599">Run the following code to create an <code class="code-inline tex2jax_ignore">aov</code> model of <code class="code-inline tex2jax_ignore">starbucks</code> and summarize it. <div class="sagecell-r" id="sage-331"><script type="text/x-sage">starbucksaov=aov(fiber ~ type, data=starbucks)
summary(starbucksaov)
</script></div></p></article><article class="task exercise-like" id="task-929"><h6 class="heading"><span class="codenumber">(c)</span></h6>
<p id="p-1600">State the meaning of the \(p\)-value within the context of this problem in a complete sentence.</p></article><article class="task exercise-like" id="task-930"><h6 class="heading"><span class="codenumber">(d)</span></h6>
<p id="p-1601">Do we  reject the null hypothesis?</p></article><article class="task exercise-like" id="task-931"><h6 class="heading"><span class="codenumber">(e)</span></h6>
<p id="p-1602">What sort of error could have been made? (Type 1 or Type 2)</p></article><article class="task exercise-like" id="task-932"><h6 class="heading"><span class="codenumber">(f)</span></h6>
<p id="p-1603">Re-run the above comparing another nutrtional variable across food type.</p></article></article></section></section></div></main>
</div>
</body>
</html>
